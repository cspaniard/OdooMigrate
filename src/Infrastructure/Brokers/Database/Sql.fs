namespace Brokers.Database.Sql

open Npgsql.FSharp

type Broker () =

    static let mutable _connectionString = ""

    //------------------------------------------------------------------------------------------------------------------
    static member init connectionString =

        _connectionString <- connectionString
    //------------------------------------------------------------------------------------------------------------------

    //------------------------------------------------------------------------------------------------------------------
    static member ConnectionString with get () = _connectionString
    //------------------------------------------------------------------------------------------------------------------

    //------------------------------------------------------------------------------------------------------------------
    static member executeQuery sql =

        Broker.ConnectionString
        |> Sql.connect
        |> Sql.query sql
    //------------------------------------------------------------------------------------------------------------------

    //------------------------------------------------------------------------------------------------------------------
    static member getExportData sql readerFun =

        Broker.executeQuery sql
        |> Sql.execute readerFun
    //------------------------------------------------------------------------------------------------------------------
